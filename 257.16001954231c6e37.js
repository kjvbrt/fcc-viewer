"use strict";(self.webpackChunkFCCViewer=self.webpackChunkFCCViewer||[]).push([[257],{6257:(H,P,h)=>{h.r(P),h.d(P,{TMultiGraphPainter:()=>g});var p=h(8428),O=h(2944),C=h(4010),G=h(9833),F=h(8221);class d extends C.tK{constructor(t,a){super(t,a),this.firstpainter=null,this.autorange=!1,this.painters=[]}cleanup(){this.painters=[],super.cleanup()}updateObject(t){if(!this.matchObjectType(t))return!1;let a=this.getObject(),r=t.fGraphs,s=this.getPadPainter();a.fTitle=t.fTitle;let m=!1;if(this.firstpainter){let e=t.fHistogram;this.autorange&&!e&&(e=this.scanGraphsRange(r)),this.firstpainter.updateObject(e)&&(m=!0)}for(let e=0;e<r.arr.length;++e)e<this.painters.length&&this.painters[e].updateObject(r.arr[e])&&(m=!0);return t.fFunctions?.arr?.forEach(e=>{e?._typename&&e?.fName&&s?.findPainterFor(null,e.fName,e._typename)?.updateObject(e)}),m}scanGraphsRange(t,a,r){let m,e,c,y,s=this.getObject(),u=0,x=0,T=!1,o=!1,X=!1,M="",i={xmin:0,xmax:0,ymin:0,ymax:0,first:!0};if(r&&(T=r.fLogx,o=r.fLogy,i.xmin=r.fUxmin,i.xmax=r.fUxmax,i.ymin=r.fUymin,i.ymax=r.fUymax,i.first=!1),this._3d&&a&&!a.fXaxis.fLabels&&(a=null),a){if(e=a.fYaxis.fXmin,m=a.fYaxis.fXmax,r){const f=n=>r.fLogx&&n<50?Math.exp(2.302585092994*n):n;u=f(i.xmin),x=f(i.xmax)}}else this.autorange=!0,t.arr.forEach(f=>{if(0!=f.fNpoints){i.first&&(i.xmin=i.xmax=f.fX[0],i.ymin=i.ymax=f.fY[0],i.first=!1);for(let n=0;n<f.fNpoints;++n)i.xmin=Math.min(i.xmin,f.fX[n]),i.xmax=Math.max(i.xmax,f.fX[n]),i.ymin=Math.min(i.ymin,f.fY[n]),i.ymax=Math.max(i.ymax,f.fY[n])}}),t.arr[0]&&t.arr[0].fHistogram&&t.arr[0].fHistogram.fXaxis.fTimeDisplay&&(X=!0,M=t.arr[0].fHistogram.fXaxis.fTimeFormat),i.xmin==i.xmax&&(i.xmax+=1),i.ymin==i.ymax&&(i.ymax+=1),c=.05*(i.xmax-i.xmin),y=.05*(i.ymax-i.ymin),u=i.xmin-c,x=i.xmax+c,o?(i.ymin<=0&&(i.ymin=.001*i.ymax),e=i.ymin/(1+.5*Math.log10(i.ymax/i.ymin)),m=i.ymax*(1+.2*Math.log10(i.ymax/i.ymin))):(e=i.ymin-y,m=i.ymax+y),e<0&&i.ymin>=0&&(e=0),m>0&&i.ymax<=0&&(m=0);if(u<0&&i.xmin>=0&&(u=T?.9*i.xmin:0),x>0&&i.xmax<=0&&(x=T?1.1*i.xmax:0),-1111!=s.fMinimum&&(i.ymin=e=s.fMinimum),-1111!=s.fMaximum&&(i.ymax=m=s.fMaximum),e<0&&i.ymin>=0&&o&&(e=.9*i.ymin),m>0&&i.ymax<=0&&o&&(m=1.1*i.ymax),e<=0&&o&&(e=.001*m),!o&&e>0&&e<.05*m&&(e=0),u<=0&&T&&(u=x>1e3?1:.001*x),!a){let f,n;if(this._3d){f=(a=(0,p.create)("TH2I")).fXaxis,f.fXmin=0,f.fXmax=t.arr.length,f.fNbins=t.arr.length,f.fLabels=(0,p.create)("THashList");for(let l=0;l<t.arr.length;l++){let w=(0,p.create)("TObjString");w.fString=t.arr[l].fTitle||`gr${l}`,w.fUniqueID=t.arr.length-l,f.fLabels.Add(w,"")}f=a.fYaxis,n=a.fZaxis}else f=(a=(0,p.create)("TH1I")).fXaxis,n=a.fYaxis;if(a.fTitle=s.fTitle,a.fTitle.indexOf(";")>=0){let l=a.fTitle.split(";");a.fTitle=l[0],l[1]&&(f.fTitle=l[1]),l[2]&&(n.fTitle=l[2])}f.fXmin=u,f.fXmax=x,f.fTimeDisplay=X,X&&(f.fTimeFormat=M)}return this._3d?(a.fMinimum=e,a.fMaximum=m):(a.fYaxis.fXmin=e,a.fYaxis.fXmax=m),a}drawAxisHist(t,a){return G.f.draw(this.getDom(),t,"AXIS"+a)}drawNextFunction(t){let a=this.getObject();return!a.fFunctions||t>=a.fFunctions.arr.length?Promise.resolve(this):this.getPadPainter().drawObject(this.getDom(),a.fFunctions.arr[t],a.fFunctions.opt[t]).then(()=>this.drawNextFunction(t+1))}drawGraph(t,a){return F.TGraphPainter.draw(this.getDom(),t,a)}drawNextGraph(t,a){let r=this.getObject().fGraphs;if(t>=r.arr.length)return this._pfc=this._plc=this._pmc=!1,this.drawNextFunction(0);if(this._pfc||this._plc||this._pmc){let m=this.getMainPainter();if("function"==typeof m?.createAutoColor){let e=m.createAutoColor(r.arr.length);this._pfc&&(r.arr[t].fFillColor=e),this._plc&&(r.arr[t].fLineColor=e),this._pmc&&(r.arr[t].fMarkerColor=e)}}return this.drawGraph(r.arr[t],r.opt[t]||a||"",r.arr.length-t).then(m=>(m&&this.painters.push(m),this.drawNextGraph(t+1,a)))}static _drawMG(t,a){let r=new O.pc(a);t._3d=r.check("3D"),t._pfc=r.check("PFC"),t._plc=r.check("PLC"),t._pmc=r.check("PMC");let s="";["USE_PAD_TITLE","LOGXY","LOGX","LOGY","LOGZ","GRIDXY","GRIDX","GRIDY","TICKXY","TICKX","TICKY","FB"].forEach(c=>{r.check(c)&&(s+=";"+c)});let e=Promise.resolve(!0);if(r.check("A")||!t.getMainPainter()){let c=t.getObject(),y=t.getPadPainter(),u=t.scanGraphsRange(c.fGraphs,c.fHistogram,y?.getRootPad(!0));e=t.drawAxisHist(u,s).then(x=>{t.firstpainter=x,x.$secondary=!0})}return e.then(()=>(t.addToPadPrimitives(),t.drawNextGraph(0,r.remain())))}static draw(t,a,r){return d._drawMG(new d(t,a),r)}}var D=h(6982),Y=h(5596);class g extends d{drawAxisHist(t,a){return this._3d?D.TH2Painter.draw(this.getDom(),t,"AXIS3D"+a):G.f.draw(this.getDom(),t,"AXIS"+a)}drawGraph(t,a,r){return this._3d&&(a+="pos3d_"+r),Y.o.draw(this.getDom(),t,a)}static draw(t,a,r){return g._drawMG(new g(t,a),r)}}}}]);